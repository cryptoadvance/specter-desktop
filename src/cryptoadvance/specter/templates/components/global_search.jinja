<script>
    highlighted_elements = []

    function reset_highlight(){
        for (var i in highlighted_elements){ 
            highlighted_elements[i].element.style.backgroundColor = highlighted_elements[i].previous_color;
        }

    }


    function global_search(search_term){
        reset_highlight();
        if (search_term==""){return}


        let url="{{ url_for('wallets_endpoint_api.global_search', search_term='search_term') }}";
        url = url.replace('search_term', search_term);
        console.log(url)
        send_request(url, 'GET', "{{ csrf_token() }}").then((answer)=> {
            if (!answer){return}
            console.log(answer)
            
            for (var i in answer.list){
                var html_element = answer.list[i];
                if (html_element.result > 0){
                    console.log(`setting green ${html_element.id}`);
                    found_element = document.getElementById(html_element.id);
                    if (!found_element) {continue}
                    highlighted_elements.push({element:found_element, previous_color:found_element.style.backgroundColor});
                    found_element.style.backgroundColor = 'green';
                }                
            }
            

        });
    }
</script>

<input  name="global_search" placeholder="Type to search" oninput="global_search(this.value)"/>
